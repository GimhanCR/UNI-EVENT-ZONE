<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<style>
/* --- Styles same as before --- */
header {
    background-color: #000;
    color: #fff;
    text-align: center;
    padding: 20px;
    font-size: 55px;
    font-weight: bold;
    letter-spacing: 1px;
}
body {
    background: url('images/itum.JPEG') no-repeat center center fixed;
    background-size: cover;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: Arial, sans-serif;
    height: 100vh;
    margin: 0;
}
p {
    background-color: rgba(255, 255, 255, 0.9);
    color: #000;
    text-align: center;
    padding: 15px 25px;
    font-size: 40px;
    font-weight: bold;
    border-radius: 8px;
    margin-top: 30px;
}
.button-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 25px;
    justify-items: center;
    margin-top: 20px;
}
.dashboard-btn {
    width: 550px;
    height: 150px;
    background-color: rgba(0, 0, 0, 0.8);
    color: #fff;
    font-size: 20px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 5px 10px rgba(0,0,0,0.3);
    transition: all 0.3s ease;
}
.dashboard-btn:hover {
    background-color: #ffcc00;
    color: #000;
}
footer {
    margin-top: auto;
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    width: 100%;
    text-align: center;
    padding: 10px;
    font-size: 16px;
}
/* Modal */
.modal {
    display: none;
    position: fixed;
    z-index: 10;
    left: 0;
    top: -25px;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    animation: fadeIn 0.4s ease;
}
.modal-content {
    background: linear-gradient(145deg, #1f1f1f, #2d2d2d);
    color: #fff;
    margin: 5% auto;
    padding: 30px 40px;
    border-radius: 15px;
    max-height: 90vh;
    overflow-y: auto;
    width: 420px;
    box-shadow: 0 0 25px rgba(0, 0, 0, 0.6);
    border: 2px solid #ffcc00;
    animation: slideDown 0.5s ease;
    position: relative;
}
#viewModal .modal-content {
    width: 70%;              /* wider than default */
    max-width: 900px;        /* don’t stretch too much on large screens */
    background: rgba(0, 0, 0, 0.9);
    border: 2px solid #ffcc00;
    border-radius: 15px;
    padding: 20px;
    color: white;
    overflow-y: auto;
}
.close {
    position: absolute;
    right: 20px;
    top: 10px;
    font-size: 28px;
    cursor: pointer;
    color: #ffcc00;
    transition: color 0.3s ease;
}
#eventsContainer {
    max-height: 400px; /* Adjust this value (in pixels) to control the visible list height */
    overflow-y: auto; /* This enables vertical scrolling for the list content */
    padding-right: 15px; /* Add padding to prevent content from sticking to the scrollbar */
}
.close:hover { color: #fff; }
.modal-content input,
.modal-content textarea {
    width: 100%;
    padding: 10px;
    margin: 8px 0 15px 0;
    border: none;
    border-radius: 8px;
    outline: none;
    font-size: 14px;
    background: rgba(255,255,255,0.1);
    color: #fff;
    box-shadow: inset 0 0 5px rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}
.modal-content input:focus,
.modal-content textarea:focus {
    background: rgba(255,255,255,0.2);
    border: 1px solid #ffcc00;
}
.modal-content button {
    width: 100%;
    padding: 12px;
    background: #ffcc00;
    color: #000;
    border: none;
    border-radius: 8px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}
.modal-content button:hover {
    background: #fff;
    color: #000;
    box-shadow: 0 0 15px #ffcc00;
}
@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
@keyframes slideDown { from {transform:translateY(-50px);opacity:0;} to {transform:translateY(0);opacity:1;} }
</style>
</head>
<body>

<header>WELCOME TO UNI-EVENT-ZONE</header>
<p>Admin Dashboard</p>

<div class="button-container">
    <button class="dashboard-btn" id="addEventBtn">Add Event</button>
    <button class="dashboard-btn" onclick="editEvent()">Edit Event</button>
    <button class="dashboard-btn" id="viewEventsBtn">View Events</button>
    <button class="dashboard-btn" onclick="deleteEvent()">Delete Event</button>
</div>

<div id="eventModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <form id="eventForm" action="event.php" method="post" onsubmit="return validateForm()">
            <label for="eventName">Event Name</label>
            <input type="text" id="eventName" name="ename" placeholder="Enter event name" required>

            <label for="eventDate">Date</label>
            <input type="date" name="edate" id="eventDate" required>

            <label for="eventTime">Time</label>
            <input type="time" id="eventTime" name="etime" required>

            <label for="venue">Venue</label>
            <input type="text" id="venue" name="evenue" placeholder="Enter Venue" required>

            <label for="organizer">Organizer(s)</label>
            <input type="text" id="organizer" name="eorganizer" placeholder="Enter organizer's name" required>

            <label for="description">Description</label>
            <textarea id="description" name="edes" placeholder="Add a description" required></textarea>

            <button type="submit">Submit Event</button>
        </form>
    </div>
</div>

<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="close edit-close">&times;</span>
    <h2>Edit Event</h2>
    <form id="editForm" action="edit.php" method="post" onsubmit="return validateEditForm()">
      <label for="eventId">Event ID</label>
      <input type="number" id="eventId" name="event_id" placeholder="Enter Event ID" required>

      <label for="fieldSelect">Field to Update</label>
      <select id="fieldSelect" name="field" required onchange="updateEditInputType()">
        <option value="">-- Select Field --</option>
        <option value="event_name">Event Name</option>
        <option value="event_date">Date</option>
        <option value="event_time">Time</option>
        <option value="venue">Venue</option>
        <option value="organizers">Organizer(s)</option>
        <option value="event_description">Description</option>
      </select>

      <label for="newValue">New Value</label>
      <div id="editValueContainer">
        <!-- default text input -->
        <input type="text" id="newValue" name="new_value" placeholder="Enter new value" required>
      </div>

      <button type="submit">Update Event</button>
    </form>
  </div>
</div>
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Delete Event</h2>
        <form id="deleteForm" action="delete.php" method="post" onsubmit="return confirmDelete()">
            <label for="deleteEventId">Event ID</label>
            <input type="number" id="deleteEventId" name="d_event_id" placeholder="Enter Event ID" required>
            <button type="submit">Delete Event</button>
        </form>
    </div>
</div>
<div id="viewModal" class="modal">
  <div class="modal-content">
    <span class="close view-close">&times;</span>
    <h2>All Events</h2>
    <div id="eventsContainer">Loading events...</div>
  </div>
</div>

<footer>© 2025 UNI-EVENT-ZONE | Admin Control Panel</footer>

<script>
const modal = document.getElementById("eventModal");
const btn = document.getElementById("addEventBtn");
const span = document.getElementsByClassName("close")[0];

// Open modal
btn.onclick = () => modal.style.display = "block";

// Close modal
span.onclick = () => modal.style.display = "none";
window.onclick = (e) => { if(e.target == modal) modal.style.display = "none"; };

// Validation function
function validateForm() {
    const name = document.getElementById("eventName").value.trim();
    const date = document.getElementById("eventDate").value.trim();
    const time = document.getElementById("eventTime").value.trim();
    const venue = document.getElementById("venue").value.trim();
    const organizer = document.getElementById("organizer").value.trim();
    const desc = document.getElementById("description").value.trim();

    if(!name || !date || !time || !venue || !organizer || !desc) {
        alert("⚠️ Please fill in all fields before submitting.");
        return false; // stop submission
    }

    alert("✅ Event added successfully! Submitting...");
    return true; // allow form to submit to event.php
}
</script>
<script>
// Modal open/close
const editModal = document.getElementById("editModal");
const editBtn = document.querySelector(".dashboard-btn[onclick='editEvent()']");
const editClose = editModal.getElementsByClassName("close")[0];

editBtn.onclick = () => editModal.style.display = "block";
editClose.onclick = () => editModal.style.display = "none";
window.onclick = (e) => { if(e.target == editModal) editModal.style.display = "none"; };

// Form validation
function validateEditForm() {
    const id = document.getElementById("eventId").value.trim();
    const field = document.getElementById("fieldSelect").value;
    const value = document.getElementById("newValue").value.trim();

    if (!id || !field || !value) {
        alert("⚠️ Please fill in all fields before submitting.");
        return false;
    }

    alert("✅ Event updated successfully! Submitting...");
    return true; // form will submit to edit_event.php
}
</script>

<script>
const deleteModal = document.getElementById("deleteModal");
const deleteBtn = document.querySelector(".dashboard-btn[onclick='deleteEvent()']");
const deleteClose = deleteModal.getElementsByClassName("close")[0];

// Open modal when clicking delete
deleteBtn.onclick = () => deleteModal.style.display = "block";

// Close modal
deleteClose.onclick = () => deleteModal.style.display = "none";
window.onclick = (e) => { if(e.target == deleteModal) deleteModal.style.display = "none"; };

// Confirmation before submitting
function confirmDelete() {
    const eventId = document.getElementById("deleteEventId").value.trim();
    if(!eventId) {
        alert("⚠️ Please enter Event ID before deleting.");
        return false;
    }

    return confirm(`❌ Are you sure you want to delete event with ID ${eventId}?`);
}
</script>

<script>
// View modal logic
const viewBtn = document.getElementById('viewEventsBtn'); // Add this ID to your View button
const viewModal = document.getElementById('viewModal');
const viewClose = viewModal.querySelector('.view-close');
const eventsContainer = document.getElementById('eventsContainer');

if (viewBtn) {
  viewBtn.addEventListener('click', () => {
    viewModal.style.display = 'block';
    loadEvents(); // fetch events when modal opens
  });
}

viewClose.addEventListener('click', () => { viewModal.style.display = 'none'; });
window.addEventListener('click', (e) => { if (e.target === viewModal) viewModal.style.display = 'none'; });

// Fetch event data from PHP and show in table
function loadEvents() {
  fetch('view_events.php')
    .then(response => response.text())
    .then(data => {
      eventsContainer.innerHTML = data;
    })
    .catch(err => {
      eventsContainer.innerHTML = "<p style='color:red;'>❌ Error loading events.</p>";
      console.error(err);
    });
}
</script>

</body>
</html>
